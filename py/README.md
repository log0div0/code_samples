
В каталоге text-detector - код нейросети, на вход которой подаётся скриншот, на выходе heatmap, показывающий, где есть текст

Пример работы - в файле text-detector-example.png

За основу была взата модель CRAFT (https://github.com/clovaai/CRAFT-pytorch), но в процессе адаптации от неё мало что осталось

Разбиение на batches и бОльшая часть искажений происходит заранее, это делается в С++ коде. Поэтому в файле dataset.py достаточно просто загрузить готовые изображения.

Моделька предсказывает отдельно верхнюю и нижнюю части строк текста (чтобы избежать слипания heatmap, если строчки расположены близко друг к другу), поэтому label делится на up и down.

На обучающих данных довольно много спорных моментов (например, крестик закрытия окна похож на букву "х"). В принципе, нам не важно, задетектятся такие случаи или нет, поэтому label также делится на positive и negative pixels. Всё, что не покрыто positive+negative, при обучении просто игнорируется.

Также добавлен focal loss, чтобы сеть не пыталась уменьшить ошибку за счёт тех пикселей, которые и так неплохо детектятся.

В каталоге homm3-detector - код для нейросети, которую я делал для статьи на Хабре (https://habr.com/ru/company/testo_lang/blog/533768/)
Примеры работы можно посмотреть в статье
